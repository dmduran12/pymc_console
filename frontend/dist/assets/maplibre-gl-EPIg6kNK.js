const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/maplibre-gl-DcnxkUgK.js","assets/maplibre-gl-Cg9ukl_k.js"])))=>i.map(i=>d[i]);
import{b as a,g as A}from"./recharts-CHDYrIv-.js";import{_ as W}from"./index-EfhfNYbp.js";const F=a.createContext(null);function ge(){var i;const e=(i=a.useContext(F))==null?void 0:i.maps,t=a.useContext(S);return a.useMemo(()=>({...e,current:t==null?void 0:t.map}),[e,t])}function Z(e,t){const n=Array.isArray(e)?e[0]:e?e.x:0,i=Array.isArray(e)?e[1]:e?e.y:0,o=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0;return n===o&&i===r}function m(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!m(e[n],t[n]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(const o of n)if(!t.hasOwnProperty(o)||!m(e[o],t[o]))return!1;return!0}return!1}function P(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function k(e,t){const n=t.viewState||t,i={};if("longitude"in n&&"latitude"in n&&(n.longitude!==e.center.lng||n.latitude!==e.center.lat)){const o=e.center.constructor;i.center=new o(n.longitude,n.latitude)}return"zoom"in n&&n.zoom!==e.zoom&&(i.zoom=n.zoom),"bearing"in n&&n.bearing!==e.bearing&&(i.bearing=n.bearing),"pitch"in n&&n.pitch!==e.pitch&&(i.pitch=n.pitch),n.padding&&e.padding&&!m(n.padding,e.padding)&&(i.padding=n.padding),i}const V=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function T(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const i of e.layers)t[i.id]=i;const n=e.layers.map(i=>{let o=null;"interactive"in i&&(o=Object.assign({},i),delete o.interactive);const r=t[i.ref];if(r){o=o||Object.assign({},i),delete o.ref;for(const s of V)s in r&&(o[s]=r[s])}return o||i});return{...e,layers:n}}const z={version:8,sources:{},layers:[]},I={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},O={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},N={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},q=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],B=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class M{constructor(t,n,i){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=o=>{const r=this.props[N[o.type]];r?r(o):o.type==="error"&&console.error(o.error)},this._onCameraEvent=o=>{if(this._internalUpdate)return;o.viewState=this._propsedCameraUpdate||P(this._map.transform);const r=this.props[O[o.type]];r&&r(o)},this._onCameraUpdate=o=>this._internalUpdate?o:(this._propsedCameraUpdate=P(o),k(o,this.props)),this._onPointerEvent=o=>{(o.type==="mousemove"||o.type==="mouseout")&&this._updateHover(o);const r=this.props[I[o.type]];r&&(this.props.interactiveLayerIds&&o.type!=="mouseover"&&o.type!=="mouseout"&&(o.features=this._hoveredFeatures||this._queryRenderedFeatures(o.point)),r(o),delete o.features)},this._MapClass=t,this.props=n,this._initialize(i)}get map(){return this._map}setProps(t){const n=this.props;this.props=t;const i=this._updateSettings(t,n),o=this._updateSize(t),r=this._updateViewState(t);this._updateStyle(t,n),this._updateStyleComponents(t),this._updateHandlers(t,n),(i||o||r&&!this._map.isMoving())&&this.redraw()}static reuse(t,n){const i=M.savedMaps.pop();if(!i)return null;const o=i.map,r=o.getContainer();for(n.className=r.className;r.childNodes.length>0;)n.appendChild(r.childNodes[0]);o._container=n;const s=o._resizeObserver;s&&(s.disconnect(),s.observe(n)),i.setProps({...t,styleDiffing:!1}),o.resize();const{initialViewState:c}=t;return c&&(c.bounds?o.fitBounds(c.bounds,{...c.fitBoundsOptions,duration:0}):i._updateViewState(c)),o.isStyleLoaded()?o.fire("load"):o.once("style.load",()=>o.fire("load")),o._update(),i}_initialize(t){const{props:n}=this,{mapStyle:i=z}=n,o={...n,...n.initialViewState,container:t,style:T(i)},r=o.initialViewState||o.viewState||o;if(Object.assign(o,{center:[r.longitude||0,r.latitude||0],zoom:r.zoom||0,pitch:r.pitch||0,bearing:r.bearing||0}),n.gl){const c=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=c,n.gl)}const s=new this._MapClass(o);r.padding&&s.setPadding(r.padding),n.cursor&&(s.getCanvas().style.cursor=n.cursor),s.transformCameraUpdate=this._onCameraUpdate,s.on("style.load",()=>{var c;this._styleComponents={light:s.getLight(),sky:s.getSky(),projection:(c=s.getProjection)==null?void 0:c.call(s),terrain:s.getTerrain()},this._updateStyleComponents(this.props)}),s.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const c in I)s.on(c,this._onPointerEvent);for(const c in O)s.on(c,this._onCameraEvent);for(const c in N)s.on(c,this._onEvent);this._map=s}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),M.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_updateSize(t){const{viewState:n}=t;if(n){const i=this._map;if(n.width!==i.transform.width||n.height!==i.transform.height)return i.resize(),!0}return!1}_updateViewState(t){const n=this._map,i=n.transform;if(!n.isMoving()){const r=k(i,t);if(Object.keys(r).length>0)return this._internalUpdate=!0,n.jumpTo(r),this._internalUpdate=!1,!0}return!1}_updateSettings(t,n){const i=this._map;let o=!1;for(const r of q)if(r in t&&!m(t[r],n[r])){o=!0;const s=i[`set${r[0].toUpperCase()}${r.slice(1)}`];s==null||s.call(i,t[r])}return o}_updateStyle(t,n){if(t.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==n.mapStyle){const{mapStyle:i=z,styleDiffing:o=!0}=t,r={diff:o};"localIdeographFontFamily"in t&&(r.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(T(i),r)}}_updateStyleComponents({light:t,projection:n,sky:i,terrain:o}){var c,l;const r=this._map,s=this._styleComponents;r.style._loaded&&(t&&!m(t,s.light)&&(s.light=t,r.setLight(t)),n&&!m(n,s.projection)&&n!==((c=s.projection)==null?void 0:c.type)&&(s.projection=typeof n=="string"?{type:n}:n,(l=r.setProjection)==null||l.call(r,s.projection)),i&&!m(i,s.sky)&&(s.sky=i,r.setSky(i)),o!==void 0&&!m(o,s.terrain)&&(!o||r.getSource(o.source))&&(s.terrain=o,r.setTerrain(o)))}_updateHandlers(t,n){const i=this._map;for(const o of B){const r=t[o]??!0,s=n[o]??!0;m(r,s)||(r?i[o].enable(r):i[o].disable())}}_queryRenderedFeatures(t){const n=this._map,{interactiveLayerIds:i=[]}=this.props;try{return n.queryRenderedFeatures(t,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(t){var o;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const r=t.type,s=((o=this._hoveredFeatures)==null?void 0:o.length)>0,c=this._queryRenderedFeatures(t.point),l=c.length>0;!l&&s&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=c,l&&!s&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=r}else this._hoveredFeatures=null}}M.savedMaps=[];const $=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function G(e){if(!e)return null;const t=e.map,n={getMap:()=>t};for(const i of K(t))!(i in n)&&!$.includes(i)&&(n[i]=t[i].bind(t));return n}function K(e){const t=new Set;let n=e;for(;n;){for(const i of Object.getOwnPropertyNames(n))i[0]!=="_"&&typeof e[i]=="function"&&i!=="fire"&&i!=="setEventedParent"&&t.add(i);n=Object.getPrototypeOf(n)}return Array.from(t)}const J=typeof document<"u"?a.useLayoutEffect:a.useEffect;function Y(e,t){const{RTLTextPlugin:n,maxParallelImageRequests:i,workerCount:o,workerUrl:r}=t;if(n&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:s,lazy:c=!0}=typeof n=="string"?{pluginUrl:n}:n;e.setRTLTextPlugin(s,l=>{l&&console.error(l)},c)}i!==void 0&&e.setMaxParallelImageRequests(i),o!==void 0&&e.setWorkerCount(o),r!==void 0&&e.setWorkerUrl(r)}const S=a.createContext(null);function Q(e,t){const n=a.useContext(F),[i,o]=a.useState(null),r=a.useRef(),{current:s}=a.useRef({mapLib:null,map:null});a.useEffect(()=>{const u=e.mapLib;let d=!0,f;return Promise.resolve(u||W(()=>import("./maplibre-gl-DcnxkUgK.js").then(h=>h.m),__vite__mapDeps([0,1]))).then(h=>{if(!d)return;if(!h)throw new Error("Invalid mapLib");const p="Map"in h?h:h.default;if(!p.Map)throw new Error("Invalid mapLib");Y(p,e),e.reuseMaps&&(f=M.reuse(e,r.current)),f||(f=new M(p.Map,e,r.current)),s.map=G(f),s.mapLib=p,o(f),n==null||n.onMapMount(s.map,e.id)}).catch(h=>{const{onError:p}=e;p?p({type:"error",target:null,originalEvent:null,error:h}):console.error(h)}),()=>{d=!1,f&&(n==null||n.onMapUnmount(e.id),e.reuseMaps?f.recycle():f.destroy())}},[]),J(()=>{i&&i.setProps(e)}),a.useImperativeHandle(t,()=>s.map,[i]);const c=a.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),l={height:"100%"};return a.createElement("div",{id:e.id,ref:r,style:c},i&&a.createElement(S.Provider,{value:s},a.createElement("div",{"mapboxgl-children":"",style:l},e.children)))}const ye=a.forwardRef(Q),X=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function _(e,t){if(!e||!t)return;const n=e.style;for(const i in t){const o=t[i];Number.isFinite(o)&&!X.test(i)?n[i]=`${o}px`:n[i]=o}}function D(e,t){if(e===t)return null;const n=U(e),i=U(t),o=[];for(const r of i)n.has(r)||o.push(r);for(const r of n)i.has(r)||o.push(r);return o.length===0?null:o}function U(e){return new Set(e?e.trim().split(/\s+/):[])}const pe=a.memo(a.forwardRef((e,t)=>{const{map:n,mapLib:i}=a.useContext(S),o=a.useRef({props:e}),r=a.useMemo(()=>{let x=!1;a.Children.forEach(e.children,v=>{v&&(x=!0)});const H={...e,element:x?document.createElement("div"):void 0},L=new i.Marker(H);return L.setLngLat([e.longitude,e.latitude]),L.getElement().addEventListener("click",v=>{var g,y;(y=(g=o.current.props).onClick)==null||y.call(g,{type:"click",target:L,originalEvent:v})}),L.on("dragstart",v=>{var y,C;const g=v;g.lngLat=r.getLngLat(),(C=(y=o.current.props).onDragStart)==null||C.call(y,g)}),L.on("drag",v=>{var y,C;const g=v;g.lngLat=r.getLngLat(),(C=(y=o.current.props).onDrag)==null||C.call(y,g)}),L.on("dragend",v=>{var y,C;const g=v;g.lngLat=r.getLngLat(),(C=(y=o.current.props).onDragEnd)==null||C.call(y,g)}),L},[]);a.useEffect(()=>(r.addTo(n.getMap()),()=>{r.remove()}),[]);const{longitude:s,latitude:c,offset:l,style:u,draggable:d=!1,popup:f=null,rotation:h=0,rotationAlignment:p="auto",pitchAlignment:b="auto"}=e;a.useEffect(()=>{_(r.getElement(),u)},[u]),a.useImperativeHandle(t,()=>r,[]);const j=o.current.props;(r.getLngLat().lng!==s||r.getLngLat().lat!==c)&&r.setLngLat([s,c]),l&&!Z(r.getOffset(),l)&&r.setOffset(l),r.isDraggable()!==d&&r.setDraggable(d),r.getRotation()!==h&&r.setRotation(h),r.getRotationAlignment()!==p&&r.setRotationAlignment(p),r.getPitchAlignment()!==b&&r.setPitchAlignment(b),r.getPopup()!==f&&r.setPopup(f);const R=D(j.className,e.className);if(R)for(const x of R)r.toggleClassName(x);return o.current.props=e,A.createPortal(e.children,r.getElement())})),ve=a.memo(a.forwardRef((e,t)=>{const{map:n,mapLib:i}=a.useContext(S),o=a.useMemo(()=>document.createElement("div"),[]),r=a.useRef({props:e}),s=a.useMemo(()=>{const c={...e},l=new i.Popup(c);return l.setLngLat([e.longitude,e.latitude]),l.once("open",u=>{var d,f;(f=(d=r.current.props).onOpen)==null||f.call(d,u)}),l},[]);if(a.useEffect(()=>{const c=l=>{var u,d;(d=(u=r.current.props).onClose)==null||d.call(u,l)};return s.on("close",c),s.setDOMContent(o).addTo(n.getMap()),()=>{s.off("close",c),s.isOpen()&&s.remove()}},[]),a.useEffect(()=>{_(s.getElement(),e.style)},[e.style]),a.useImperativeHandle(t,()=>s,[]),s.isOpen()){const c=r.current.props;(s.getLngLat().lng!==e.longitude||s.getLngLat().lat!==e.latitude)&&s.setLngLat([e.longitude,e.latitude]),e.offset&&!m(c.offset,e.offset)&&s.setOffset(e.offset),(c.anchor!==e.anchor||c.maxWidth!==e.maxWidth)&&(s.options.anchor=e.anchor,s.setMaxWidth(e.maxWidth));const l=D(c.className,e.className);if(l)for(const u of l)s.toggleClassName(u);r.current.props=e}return A.createPortal(e.children,o)}));function E(e,t,n,i){const o=a.useContext(S),r=a.useMemo(()=>e(o),[]);return a.useEffect(()=>{const s=t,c=typeof t=="function"?t:null,{map:l}=o;return l.hasControl(r)||l.addControl(r,s==null?void 0:s.position),()=>{c&&c(o),l.hasControl(r)&&l.removeControl(r)}},[]),r}function ee(e){const t=E(({mapLib:n})=>new n.AttributionControl(e),{position:e.position});return a.useEffect(()=>{_(t._container,e.style)},[e.style]),null}a.memo(ee);function te(e){const t=E(({mapLib:n})=>new n.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return a.useEffect(()=>{_(t._controlContainer,e.style)},[e.style]),null}a.memo(te);function ne(e,t){const n=a.useRef({props:e}),i=E(({mapLib:o})=>{const r=new o.GeolocateControl(e),s=r._setupUI;return r._setupUI=()=>{r._container.hasChildNodes()||s()},r.on("geolocate",c=>{var l,u;(u=(l=n.current.props).onGeolocate)==null||u.call(l,c)}),r.on("error",c=>{var l,u;(u=(l=n.current.props).onError)==null||u.call(l,c)}),r.on("outofmaxbounds",c=>{var l,u;(u=(l=n.current.props).onOutOfMaxBounds)==null||u.call(l,c)}),r.on("trackuserlocationstart",c=>{var l,u;(u=(l=n.current.props).onTrackUserLocationStart)==null||u.call(l,c)}),r.on("trackuserlocationend",c=>{var l,u;(u=(l=n.current.props).onTrackUserLocationEnd)==null||u.call(l,c)}),r},{position:e.position});return n.current.props=e,a.useImperativeHandle(t,()=>i,[]),a.useEffect(()=>{_(i._container,e.style)},[e.style]),null}a.memo(a.forwardRef(ne));function oe(e){const t=E(({mapLib:n})=>new n.NavigationControl(e),{position:e.position});return a.useEffect(()=>{_(t._container,e.style)},[e.style]),null}const _e=a.memo(oe);function re(e){const t=E(({mapLib:r})=>new r.ScaleControl(e),{position:e.position}),n=a.useRef(e),i=n.current;n.current=e;const{style:o}=e;return e.maxWidth!==void 0&&e.maxWidth!==i.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==i.unit&&t.setUnit(e.unit),a.useEffect(()=>{_(t._container,o)},[o]),null}const Ce=a.memo(re);function ie(e){const t=E(({mapLib:n})=>new n.TerrainControl(e),{position:e.position});return a.useEffect(()=>{_(t._container,e.style)},[e.style]),null}a.memo(ie);function se(e){const t=E(({mapLib:n})=>new n.LogoControl(e),{position:e.position});return a.useEffect(()=>{_(t._container,e.style)},[e.style]),null}a.memo(se);function w(e,t){if(!e)throw new Error(t)}let ae=0;function ce(e,t,n){if(e.style&&e.style._loaded){const i={...n};return delete i.id,delete i.children,e.addSource(t,i),e.getSource(t)}return null}function le(e,t,n){var s,c,l;w(t.id===n.id,"source id changed"),w(t.type===n.type,"source type changed");let i="",o=0;for(const u in t)u!=="children"&&u!=="id"&&!m(n[u],t[u])&&(i=u,o++);if(!o)return;const r=t.type;if(r==="geojson")e.setData(t.data);else if(r==="image")e.updateImage({url:t.url,coordinates:t.coordinates});else switch(i){case"coordinates":(s=e.setCoordinates)==null||s.call(e,t.coordinates);break;case"url":(c=e.setUrl)==null||c.call(e,t.url);break;case"tiles":(l=e.setTiles)==null||l.call(e,t.tiles);break;default:console.warn(`Unable to update <Source> prop: ${i}`)}}function Le(e){const t=a.useContext(S).map.getMap(),n=a.useRef(e),[,i]=a.useState(0),o=a.useMemo(()=>e.id||`jsx-source-${ae++}`,[]);a.useEffect(()=>{if(t){const s=()=>setTimeout(()=>i(c=>c+1),0);return t.on("styledata",s),s(),()=>{var c;if(t.off("styledata",s),t.style&&t.style._loaded&&t.getSource(o)){const l=(c=t.getStyle())==null?void 0:c.layers;if(l)for(const u of l)u.source===o&&t.removeLayer(u.id);t.removeSource(o)}}}},[t]);let r=t&&t.style&&t.getSource(o);return r?le(r,e,n.current):r=ce(t,o,e),n.current=e,r&&a.Children.map(e.children,s=>s&&a.cloneElement(s,{source:o}))||null}function ue(e,t,n,i){if(w(n.id===i.id,"layer id changed"),w(n.type===i.type,"layer type changed"),n.type==="custom"||i.type==="custom")return;const{layout:o={},paint:r={},filter:s,minzoom:c,maxzoom:l,beforeId:u}=n;if(u!==i.beforeId&&e.moveLayer(t,u),o!==i.layout){const d=i.layout||{};for(const f in o)m(o[f],d[f])||e.setLayoutProperty(t,f,o[f]);for(const f in d)o.hasOwnProperty(f)||e.setLayoutProperty(t,f,void 0)}if(r!==i.paint){const d=i.paint||{};for(const f in r)m(r[f],d[f])||e.setPaintProperty(t,f,r[f]);for(const f in d)r.hasOwnProperty(f)||e.setPaintProperty(t,f,void 0)}m(s,i.filter)||e.setFilter(t,s),(c!==i.minzoom||l!==i.maxzoom)&&e.setLayerZoomRange(t,c,l)}function fe(e,t,n){if(e.style&&e.style._loaded&&(!("source"in n)||e.getSource(n.source))){const i={...n,id:t};delete i.beforeId,e.addLayer(i,n.beforeId)}}let de=0;function Se(e){const t=a.useContext(S).map.getMap(),n=a.useRef(e),[,i]=a.useState(0),o=a.useMemo(()=>e.id||`jsx-layer-${de++}`,[]);if(a.useEffect(()=>{if(t){const s=()=>i(c=>c+1);return t.on("styledata",s),s(),()=>{t.off("styledata",s),t.style&&t.style._loaded&&t.getLayer(o)&&t.removeLayer(o)}}},[t]),t&&t.style&&t.getLayer(o))try{ue(t,o,e,n.current)}catch(s){console.warn(s)}else fe(t,o,e);return n.current=e,null}export{Se as L,ye as M,_e as N,ve as P,Le as S,pe as a,Ce as b,ge as u};
